rule LockBit3_ransomware {
    meta: 
        author = "BlackBerry"
        date = "2022-08-03"
        version = "1"
        TLP = "clear"
        description = "Rule detecting Lockbit3 ransomware samples"
	yarahub_reference_md5 = "44e8c23bfb649ecf4cb753ec332899dd"
	yarahub_uuid = "fa7215eb-3fc5-4b15-b44d-2b182d7c5e66"
	yarahub_license = "CC BY 4.0"
	yarahub_rule_matching_tlp = "TLP:WHITE"
	yarahub_rule_sharing_tlp = "TLP:WHITE"
    strings: 
        $code1 = {004E01536574506978656C0000590153657454657874436F6C6F7200006B01546578744F757457000067646933322E646C6C0063004372656174654469616C6F67506172616D570000}
        $code2 = {7D0C66AD6685C07505E98A0000006683F841720C6683F84677066683E837EB266683F861720C6683F86677066683E857EB146683F830720C6683F83977066683E830EB02EBBC0FB6C8C1E10466AD6685C07502EB436683F841720C6683F84677066683E837EB296683F861720C6683F86677066683E857EB176683F830720C6683F83977066683E830EB05E972FFFFFF32C1AAE96AFFFF}
        $code3 = {FFFF8BC885C974348BF78BD166B82000F266AF85C975128BCA894DFC8B7D0CF366A56633C066ABEB132BD14A87D1894DFC8B7D0CF366A56633C066AB8B45FC5F5E5A8BE55DC2080090558BEC81EC840000}
    condition:
        uint16(0) == 0x5a4d and
        filesize < 3MB and
        2 of them
}
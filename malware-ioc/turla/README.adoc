
:toc:
:toclevels: 2

= Turla Indicators of Compromise

== Carbon Indicators of Compromise

The blog post about Carbon is available on WeLiveSecurity at
https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/

=== ESET detection names
- Win32/Turla.AN
- Win32/Turla.BT
- Win32/Turla.BU
- Win64/Turla.E
- Win64/Turla.K
- Win64/Turla.S
- Win64/Turla.T

=== Network indicators

==== C&C servers

(hacked websites used as 1st level proxies)

- `www.shoppingexpert.it:80:/wp-content/gallery/`
- `soheylistore.ir:80:/modules/mod_feed/feed.php`
- `tazohor.com:80:/wp-includes/feed-rss-comments.php`
- `jucheafrica.com:80:/wp-includes/class-wp-edit.php`
- `61paris.fr:80:/wp-includes/ms-set.php`
- `doctorshand.org:80:/wp-content/about/`
- `www.lasac.eu:80:/credit_payment/url/`

=== Samples

All hashes are SHA-1

==== Carbon 3.71 loader

----
1ad46547e3dc264f940bf62df455b26e65b0101f
a28164de29e51f154be12d163ce5818fceb69233
20393222d4eb1ba72a6536f7e67e139aadfa47fe
1dbfcb9005abb2c83ffa6a3127257a009612798c
----

==== Carbon 3.71 dropper

----
cbde204e7641830017bb84b89223131b2126bc46
----

==== Orchestrator 3.71

----
7c43f5df784bf50423620d8f1c96e43d8d9a9b28
2f7e335e092e04f3f4734b60c5345003d10aa15d
----

==== Carbon 3.77 loader

----
777e2695ae408e1578a16991373144333732c3f6
de2132d7d07b0b21f3c283c68031e0dd6d2b5cbd
----

==== Carbon 3.77 dropper

----
7f3a60613a3bdb5f1f8616e6ca469d3b78b1b45b
----

==== Orchestrator 3.77

----
56b5627debb93790fdbcc9ecbffc3260adeafbab
----

==== Orchestrator 3.79

----
2227fd6fc9d669a9b66c59593533750477669557
----

==== Carbon 3.81 loader

----
4636dccac5acf1d95a474747bb7bcd9b1a506cc3
----

==== Orchestrator 3.81

----
fbc43636e3c9378162f3b9712cb6d87bd48ddbd3
554f59c1578f4ee77dbba6a23507401359a59f23
a08b8371ead1919500a4759c2f46553620d5a9d9
----

==== Communication library 3.62

----
7ce746bb988cb3b7e64f08174bdb02938555ea53
311f399c299741e80db8bec65bbf4b56109eedaf
87d718f2d6e46c53490c6a22de399c13f05336f0
----

==== Communication library 4.00

----
bcf52240cc7940185ce424224d39564257610340
678d486e21b001deb58353ca0255e3e5678f9614
1b233af41106d7915f6fa6fd1448b7f070b47eb3
851e538357598ed96f0123b47694e25c2d52552b
744b43d8c0fe8b217acf0494ad992df6d5191ed9
----

== Gazer Indicators of Compromise

The white paper about Gazer is available on WeLiveSecurity at
https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf.

A high level summary is also available as a blog post on WeLiveSecurity at
https://www.welivesecurity.com/2017/08/30/eset-research-cyberespionage-gazer/.

=== File names

 * `%TEMP%\KB943729.log`
 * `%TEMP%\CVRG72B5.tmp.cvr`
 * `%TEMP%\CVRG1A6B.tmp.cvr`
 * `%TEMP%\CVRG38D9.tmp.cvr`
 * `%TEMP%\~DF1E06.tmp`
 * `%HOMEPATH%\ntuser.dat.LOG3`
 * `%HOMEPATH%\AppData\Local\Adobe\AdobeUpdater.exe`

=== Registry keys

 * `HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ScreenSaver`
 * `HKCU\Software\Microsoft\Windows NT\CurrentVersion\Explorer\ScreenSaver`

=== Mutex

 * `{531511FA-190D-5D85-8A4A-279F2F592CC7}`

=== C&C servers

 * `hxxp://daybreakhealthcare.co.uk/wp-includes/themees.php`
 * `hxxp://simplecreative.design/wp-content/plugins/calculated-fields-form/single.php`
 * `hxxp://169.255.137.203/rss_0.php`
 * `hxxp://outletpiumini.springwaterfeatures.com/wp-includes/pomo/settings.php`
 * `hxxp://zerogov.com/wp-content/plugins.deactivate/paypal-donations/src/PaypalDonations/SimpleSubsribe.php`
 * `hxxp://ales.ball-mill.es/ckfinder/core/connector/php/php4/CommandHandler/CommandHandler.php`
 * `hxxp://dyskurs.com.ua/wp-admin/includes/map-menu.php`
 * `hxxp://warrixmalaysia.com.my/wp-content/plugins/jetpack/modules/contact-form/grunion-table-form.php`
 * `hxxp://217.171.86.137/config.php`
 * `hxxp://217.171.86.137/rss_0.php`
 * `hxxp://shinestars-lifestyle.com/old_shinstar/includes/old/front_footer.old.php`
 * `hxxp://www.aviasiya.com/murad.by/life/wp-content/plugins/wp-accounting/inc/pages/page-search.php`
 * `hxxp://baby.greenweb.co.il/wp-content/themes/san-kloud/admin.php`
 * `hxxp://soligro.com/wp-includes/pomo/db.php`
 * `hxxp://giadinhvabe.net/wp-content/themes/viettemp/out/css/class.php`
 * `hxxp://tekfordummies.com/wp-content/plugins/social-auto-poster/includes/libraries/delicious/Delicious.php`
 * `hxxp://kennynguyen.esy.es/wp-content/plugins/wp-statistics/vendor/maxmind-db/reader/tests/MaxMind/Db/test/Reader/BuildTest.php`
 * `hxxp://sonneteck.com/wp-content/plugins/yith-woocommerce-wishlist/plugin-fw/licence/templates/panel/activation/activation.php`
 * `hxxp://chagiocaxuanson.esy.es/wp-content/plugins/nextgen-gallery/products/photocrati_nextgen/modules/ngglegacy/admin/templates/manage_gallery/gallery_preview_page_field.old.php`
 * `hxxp://hotnews.16mb.com/wp-content/themes/twentysixteen/template-parts/content-header.php`
 * `hxxp://zszinhyosz.pe.hu/wp-content/themes/twentyfourteen/page-templates/full-hight.php`
 * `hxxp://weandcats.com/wp-content/plugins/broken-link-checker/modules/checkers/http-module.php``

=== Samples

.Gazer sample hashes
[options="header"]
|========================================
|SHA-1 hash|Component|Compilation Time|Certificate|ESET Detection Name
|`35f205367e2e5f8a121925bbae6ff07626b526a7`|Gazer loader x32|05/02/2002 17:36:10|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win32/Turla.CC
|`b151cd7c4f9e53a8dcbdeb7ce61ccdd146eb68ab`|Gazer loader x32|05/02/2002 17:36:10|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win32/Turla.CC
|`e40bb5beec5678537e8fe537f872b2ad6b77e08a`|Gazer loader x32|05/02/2002 17:36:10|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win32/Turla.CC
|`522e5f02c06ad215c9d0c23c5a6a523d34ae4e91`|Gazer loader x64|05/02/2002 17:36:26|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win64/Turla.AA
|`c380038a57ffb8c064851b898f630312fabcbba7`|Gazer loader x64|05/02/2002 17:36:26|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win64/Turla.AA
|`267f144d771b4e2832798485108decd505cb824a`|Gazer loader x64|05/02/2002 17:36:26|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win64/Turla.AA
|`52f6d09cccdbc38d66c184521e7ccf6b28c4b4d9`|Gazer loader x32|04/10/2002 18:31:37|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win32/Turla.CC
|`475c59744accb09724dae610763b7284646ab63f`|Gazer loader x32|04/10/2002 18:31:37|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win32/Turla.CC
|`22542a3245d52b7bcdb3eaef5b8b2693f451f497`|Gazer loader x32|04/10/2002 18:31:37|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win32/Turla.CC
|`2b9faa8b0fcadac710c7b2b93d492ff1028b5291`|Gazer loader x64|04/10/2002 18:34:18|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win64/Turla.AA
|`e05ab6978c17724b7c874f44f8a6cbfb1c56418d`|Gazer loader x64|04/10/2002 18:34:18|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win64/Turla.AA
|`6dec3438d212b67356200bbac5ec7fa41c716d86`|Gazer loader x64|04/10/2002 18:34:18|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win64/Turla.AA
|`b548863df838069455a76d2a63327434c02d0d9d`|Gazer loader x64|09/01/2016 19:30:10|not signed|Win64/Turla.AA
|`c3e6511377dfe85a34e19b33575870dda8884c3c`|Gazer loader x64|06/02/2016 19:29:15|admin@ultimatecomsup.biz valid from 16/12/2015 to 16/12/2017|Win64/Turla.AA
|`9ff4f59ca26388c37d0b1f0e0b22322d926e294a`|Gazer loader x64|16/02/2016 16:00:44|admin@ultimatecomsup.biz valid from 16/12/2015 to 16/12/2017|Win64/Turla.AA
|`029aa51549d0b9222db49a53d2604d79ad1c1e59`|Gazer loader x64|18/02/2016 15:29:58|admin@ultimatecomsup.biz valid from 16/12/2015 to 16/12/2017|Win64/Turla.AA
|`cecc70f2b2d50269191336219a8f893d45f5e979`|Gazer loader x64|01/01/2017 08:39:30|admin@ultimatecomsup.biz valid from 16/12/2015 to 16/12/2017|Win64/Turla.AG
|`7fac4fc130637afab31c56ce0a01e555d5dea40d`|Gazer loader x64|11/06/2017 23:43:51|admin@ultimatecomsup.biz valid from 16/12/2015 to 16/12/2017|Win64/Turla.AD
|`5838A51426CA6095B1C92B87E1BE22276C21A044`|Gazer loader x32|19/06/2017 01:28:51|admin@ultimatecomsup.biz valid from 16/12/2015 to 16/12/2017|Win32/Turla.CF
|`3944253F6B7019EED496FAD756F4651BE0E282B4`|Gazer loader x64|19/06/2017 01:30:00|admin@ultimatecomsup.biz valid from 16/12/2015 to 16/12/2017|Win64/Turla.AD
|`228da957a9ed661e17e00efba8e923fd17fae054`|Gazer orchestrator x32|05/02/2002 17:31:28|not signed|Win32/Turla.CF
|`295d142a7bdced124fdcc8edfe49b9f3acceab8a`|Gazer orchestrator x32|05/02/2002 17:31:28|not signed|Win32/Turla.CF
|`0f97f599fab7f8057424340c246d3a836c141782`|Gazer orchestrator x32|05/02/2002 17:31:28|not signed|Win32/Turla.CF
|`dbb185e493a0fdc959763533d86d73f986409f1b`|Gazer orchestrator x32|05/02/2002 17:31:28|not signed|Win32/Turla.CC
|`4701828dee543b994ed2578b9e0d3991f22bd827`|Gazer orchestrator x64|05/02/2002 17:34:25|not signed|Win64/Turla.AA
|`6fd611667ba19691958b5b72673b9b802edd7ff8`|Gazer orchestrator x64|05/02/2002 17:34:25|not signed|Win64/Turla.AA
|`fcabeb735c51e2b8eb6fb07bda8b95401d069bd8`|Gazer orchestrator x64|05/02/2002 17:34:25|not signed|Win64/Turla.AA
|`75831df9cbcfd7bf812511148d2a0f117324a75f`|Gazer orchestrator x32|04/10/2002 18:31:28|not signed|Win32/Turla.CC
|`bae3ae65c32838fb52a0f5ad2cde8659d2bff9f3`|Gazer orchestrator x32|04/10/2002 18:31:28|not signed|Win32/Turla.CC
|`37ff6841419adc51eeb8756660b2fb46f3eb24ed`|Gazer orchestrator x64|04/10/2002 18:33:02|not signed|Win64/Turla.AA
|`9e6de3577b463451b7afce24ab646ef62ad6c2bd`|Gazer orchestrator x64|04/10/2002 18:33:02|not signed|Win64/Turla.AA
|`795c6ee27b147ff0a05c0477f70477e315916e0e`|Gazer orchestrator x64|04/10/2002 18:33:02|not signed|Win64/Turla.AA
|`8184ad9d6bbd03e99a397f8e925fa66cfbe5cf1b`|Gazer orchestrator x64|09/01/2016 19:28:29|not signed|Win64/Turla.AA
|`7ced96b08d7593e28fee616eccbc6338896517cf`|Gazer orchestrator x64|06/02/2016 19:29:04|not signed|Win64/Turla.AA
|`63c534630c2ce0070ad203f9704f1526e83ae586`|Gazer orchestrator x64|06/02/2016 19:29:04|not signed|Win64/Turla.AA
|`23f1e3be3175d49e7b262cd88cfd517694dcba18`|Gazer orchestrator x64|18/02/2016 15:29:32|not signed|Win64/Turla.AA
|`7a6f1486269abdc1d658db618dc3c6f2ac85a4a7`|Gazer orchestrator x64|01/01/2017 08:39:19|not signed|Win64/Turla.AG
|`11B35320FB1CF21D2E57770D8D8B237EB4330EAA`|Gazer orchestrator x64|11/06/2017 23:42:28|not signed|Win64/Turla.AD
|`E8A2BAD87027F2BF3ECAE477F805DE13FCCC0181`|Gazer orchestrator x32|19/06/2017 01:28:21|not signed|Win32/Turla.CF
|`950F0B0C7701835C5FBDB6C5698A04B8AFE068E6`|Gazer orchestrator x64|19/06/2017 01:29:46|not signed|Win64/Turla.AD
|`a5eec8c6aadf784994bf68d9d937bb7af3684d5c`|Gazer comm x64|05/02/2002 17:57:07|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win64/Turla.AH
|`411ef895fe8dd4e040e8bf4048f4327f917e5724`|Gazer comm x32|05/02/2002 17:58:22|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win32/Turla.CC
|`c1288df9022bcd2c0a217b1536dfa83928768d06`|Gazer comm x32|06/02/2016 19:23:52|not signed|Win32/Turla.CC
|`4b6ef62d5d59f2fe7f245dd3042dc7b83e3cc923`|Gazer comm x32|11/06/2017 23:44:24|not signed|Win32/Turla.CF
|`7f54f9f2a6909062988ae87c1337f3cf38d68d35`|Gazer wiper x32|05/02/2002 17:39:07|admin@solidloop.org valid from 14/10/2015 to 14/10/2016|Win32/Turla.CL
|`27FA78DE705EBAA4B11C4B5FE7277F91906B3F92`|Gazer wiper x32|07/04/2016 15:04:24|not signed|Win32/Turla.CL
|========================================

=== Function names

There are few samples of Gazer that use the current function name as first parameter for the log function.
Here is a list of some function names used in Gazer:

* `AutorunManager` Class
** `AutorunManager::~AutorunManger`
** `AutorunManager::Init`
** `AutorunManger::ReInit`
** `AutorunManager::BuildAutorunSettings`
** `AutorunManager::FreeAutorunsSettings`
** `AutorunManager::FullCheck`
** `AutorunManager::StartAutorunEx`
** `AutorunManager::FullStart`

* `HiddenTaskAutorun` Class
** `HiddenTaskAutorun::IsPathsEqual`

* `LinkAutorun` Class
** `LinkAutorunClass::InfectLnkFile`
** `LinkAutorunClass::ClearLnkFile`
** `LinkAutorunClass::CheckLnkFile`

* `RemoteImport32` Class
** `RemoteImport32::RemoteImport32`
** `RemoteImport32::GetRemoteProcAddress`
** `RemoteImport32::GetRemoteModuleHandle`

* `ScreenSaverAutorun` Class
** `ScreenSaverAutorun::ChangeScreenSaver`
** `ScreenSaverAutorun::WndProc1`
** `ScreenSaverAutorun::GetMessageThreadProc`
** `ScreenSaverAutorun::CreateHiddenWindow`
** `ScreenSaverAutorun::CloseHiddenWindow`

* `ShellAutorun` Class
** `ShellAutorun::AutorunInstallEx`
** `ShellAutorun::AutorunUninstallEx`
** `ShellAutorun::AutorunCheckEx`
** `ShellAutorun::IsPathsEqual`

* `StartupAutorun` Class
** `StartupAutorun::AutorunInstallEx`
** `StartupAutorun::AutorunUninstallEx`
** `StartupAutorun::AutorunCheckEx`
** `StartupAutorun::IsPathsEqual`

* `TaskScheduler20Autorun` Class
** `TaskScheduler20Autorun::Init`
** `TaskScheduler20Autorun::AutorunCheckEx`
** `TaskScheduler20Autorun::AutorunInstallEx`
** `TaskScheduler20Autorun::AutorunUninstallEx`
** `TaskScheduler20Autorun::IsPathsEqual`

* `DllInjector` Class
** `DllInjector::LoadDllToProcess`
** `DllInjector::GetProcHandle`
** `DllInjector::CheckDllAndSetPlatform`
** `DllInjector::CopyDllFromBuffer`
** `DllInjector::MapLibrary`
** `DllInjector::Map86Library_tox64`
** `DllInjector::CallEntryPoint`
** `DllInjector::FindDllImageBase`
** `DllInjector::WindowInject`

* `InjectManager` Class
** `InjectManager::~InjectManager`
** `InjectManager::BuildInjectSettingsList`
** `InjectManager::FreeInjectSettingsList`
** `InjectManager::Stop`
** `InjectManager::DetachAll`
** `InjectManager::FindAndInjectInVictim`
** `InjectManager::FindProcessSimple2`
** `InjectManager::LoadNtdll`
** `InjectManager::UnLoadNtdll`
** `InjectManager::LoadWinsta`
** `InjectManager::UnLoadWinsta`
** `InjectManager::SetStatusTransportDll`
** `InjectManager::GetTransportState`
** `InjectManager::DestroyManuallyCreatedVictim`
** `InjectManager::VictimManualCreateIE`

* `NPTransport` Class
** `TNPTransport::Init`
** `TNPTransport::ReInit`
** `TNPTransport::~TNPTransport`
** `TNPTransport::Receive`
** `TNPTransport::RunServer`
** `TNPTransport::ServerProc`

* `ExeStorage` Class
** `ExeStorage::Migrate`
** `ExeStorage::SecureHeapFree`

* `FSStorage` Class
** `FSStorage::~FSStorage`
** `FSStorage::Init`
** `FSStorage::GetBlock`
** `FSStorage::GetListBlock`
** `FSStorage::Migrate`
** `FSStorage::SecureHeapFree`
** `FSStorage::Update`
** `FSStorage::Empty`

* `RegStorage` Class
** `RegStorage::~RegStorage`
** `RegStorage::Init`
** `RegStorage::FreeList`
** `RegStorage::GetListBlock`
** `RegStorage::DeleteListBlock`
** `RegStorage::Migrate`
** `RegStorage::SecureHeapFree`
** `RegStorage::Update`
** `RegStorage::Empty`

* `ResultQueue` Class
** `ResultQueue::~ResultQueue`
** `ResultQueue::DumpQueueToStorage`
** `ResultQueue::RestoreFromStorage`
** `ResultQueue::ClearQueue`
** `ResultQueue::RemoveResult`
** `ResultQueue::GetNextResultToSendWithModule`
** `ResultQueue::SetPredeterminedResult`
** `ResultQueue::print`

* `TaskQueue` Class
** `TaskQueue::~TaskQueue`
** `TaskQueue::DumpQueueToStorage`
** `TaskQueue::RestoreFromStorage`
** `TaskQueue::ClearQueue`
** `TaskQueue::RemoveCompletedTasks`
** `TaskQueue::print`

* `CExecutionSubsystem` Class
** `CExecutionSubsystem::~CExecutionSubsystem`
** `CExecutionSubsystem::Stop`
** `CExecutionSubsystem::TaskExecusion`
** `CExecutionSubsystem::TaskConfigure`
** `CExecutionSubsystem::TaskUpload`
** `CExecutionSubsystem::TaskDownload`
** `CExecutionSubsystem::TaskReplacement`
** `CExecutionSubsystem::TaskDelete`
** `CExecutionSubsystem::TaskPacketLocalTransport`
** `CExecutionSubsystem::FinishTask`
** `CExecutionSubsystem::PushTaskResult`
** `CExecutionSubsystem::UpdateStorage`

* `CMessageProcessingSystem` Class
** `CMessageProcessingSystem::~CMessageProcessing`
** `CMessageProcessingSystem::ListenerCallBack`
** `CMessageProcessingSystem::WaitShutdownModule`
** `CMessageProcessingSystem::SetCompulsorySMC`
** `CMessageProcessingSystem::UnSetCompulsorySMC`
** `CMessageProcessingSystem::IsCompulsorySMC`
** `CMessageProcessingSystem::GetCompulsorySMC`
** `CMessageProcessingSystem::Receive_TAKE_NOP`
** `CMessageProcessingSystem::Receive_GIVE_SETTINGS`
** `CMessageProcessingSystem::Receive_TAKE_CAN_NOT_WORK`
** `CMessageProcessingSystem::Receive_GIVE_CACHE`
** `CMessageProcessingSystem::Receive_TAKE_CACHE`
** `CMessageProcessingSystem::Receive_TAKE_TASK`
** `CMessageProcessingSystem::Receive_GIVE_RESULT`
** `CMessageProcessingSystem::Receive_TAKE_CONFIRM_RESULT`
** `CMessageProcessingSystem::Receive_TAKE_LOADER_BODY`
** `CMessageProcessingSystem::Receive_TAKE_UNINSTALL`
** `CMessageProcessingSystem::Receive_NO_CONNECT_TO_Gazer`
** `CMessageProcessingSystem::Receive_TAKE_LAST_CONNECTION`
** `CMessageProcessingSystem::Send_TAKE_FIN`
** `CMessageProcessingSystem::Send_TAKE_SHUTDOWN`
** `CMessageProcessingSystem::Send_TAKE_SETTINGS`
** `CMessageProcessingSystem::Send_TAKE_RESULT`

* `Crypto` Class
** `Crypto::GetPublicKey`
** `Crypto::EncryptRSA`
** `Crypto::Sign`
** `Crypto::EncryptAndSignBufferRSAEx`
** `Crypto::DecryptRSA`
** `Crypto::Verify`
** `Crypto::DecryptAndVerifyBufferRSAEx`
** `Crypto::EncryptAndSignBufferRSA1`
** `Crypto::EncryptAndSignBufferRSAC`
** `Crypto::DecryptAndVerifyBufferRSA0`
** `Crypto::DecryptAndVerifyBufferRSA1`
** `Crypto::DecryptAndVerifyBufferRSAL`
** `Crypto::VerifyLoaderFile`
** `Crypto::VerifyLoader`
** `Crypto::CompressBuffer`
** `Crypto::DecompressBuffer`

* `LTManager` Class
** `LTManager::~LTManager`
** `LTManager::Init`
** `LTManager::GetResultFromQueue`
** `LTManager::SetResultToCache`
** `LTManager::GetTaskFromCache`
** `LTManager::SetTaskToQueue`
** `LTManager::IsSendPacketFurtherOnRoute`
** `LTManager::SendPacketNextRouteUnit`
** `LTManager::SetCache`
** `LTManager::SetPacket`
** `LTManager::DumpCacheToStorage`
** `LTManager::DeSerializeCache`
** `LTManager::DeSerializePacket`
** `LTManager::DeSerializeRoute`
** `LTManager::DeSerializeTask`
** `LTManager::DeSerializeResult`
** `LTManager::SerializeCache`
** `LTManager::SerializePacket`
** `LTManager::SerialiazeRoute`
** `LTManager::SerializeTask`
** `LTManager::SerializeResult`
** `LTManager::ClearCache`
** `LTManager::ClearPacket`
** `LTManager::ClearRoute`
** `LTManager::ClearTask`
** `LTManager::ClearResult`
** `LTManager::PrintCache`
** `LTManager::CreateEvents`
** `LTManager::SetEvents`
** `LTManager::ResetEvents`
** `LTManager::WaitEvents`
** `LTManager::DeleteEvents`

* `LTMessageProcessing` Class
** `LTMessageProcessing::ListenerCallBack`
** `LTMessageProcessing::Send_TAKE_OK`
** `LTMessageProcessing::Send_TAKE_ERROR_CRYPT`
** `LTMessageProcessing::Send_TAKE_ERROR_UNKNOWN`

* `LTNamedPipe` Class
** `LTNamedPipe::ReInit`
** `LTNamedPipe::BuildLocalTransportSettings`
** `LTNamedPipe::~LTNamedPipe`
** `LTNamedPipe::Receive`
** `LTNamedPipe::RunServer`
** `LTNamedPipe::Stop`
** `LTNamedPipe::CreateNewNPInstance`
** `LTNamedPipe::ServerProc`
** `LTNamedPipe::ClientCommunication`

== Mosquito Indicators of Compromise

The blog post about Mosquito is available on WeLiveSecurity at https://www.welivesecurity.com/2018/01/09/turlas-backdoor-laced-flash-player-installer/.

=== ESET detection names

==== Recent samples

- Win32/Turla.CQ
- Win32/Turla.CP
- Win32/Turla.CR
- Win32/Turla.CS
- Win32/Turla.CT
- Win32/Turla.CU
- Win32/Turla.CV
- Win32/Turla.CW
- Win32/Turla.CX

==== Older variants
- Win32/TrojanDownloader.CAM
- Win32/TrojanDownloader.DMU

==== JScript backdoor
- JS/Agent.NWB
- JS/TrojanDownloader.Agent.REG

=== Network indicators (C&C servers)

==== Win32 backdoor
- smallcloud[.]ga
- fleetwood[.]tk
- adstore.twilightparadox[.]com
- bigpen[.]ga
- ebay-global.publicvm[.]com
- psychology-blog.ezua[.]com
- agony.compress[.]to
- gallop.mefound[.]com
- auberdine.etowns[.]net
- skyrim.3d-game[.]com
- officebuild.4irc[.]com
- sendmessage.mooo[.]com
- robot.wikaba[.]com
- tellmemore.4irc[.]com

==== JScript backdoor
- `++https://script.google[.]com/macros/s/AKfycbxxPPyGP3Z5wgwbsmXDgaNcQ6DCDf63vih-Te_jKf9SMj8TkTie/exec++`
- `++https://script.google[.]com/macros/s/AKfycbwF_VS5wHqlHmi4EQoljEtIsjmglLBO69n_2n_k2KtBqWXLk3w/exec++`

==== Fake adobe URLs

- `++http://get.adobe[.]com/stats/AbfFcBebD/?q=<base64-encoded data>++`
- `++http://get.adobe[.]com/flashplayer/download/update/x32++`
- `++http://get.adobe[.]com/flashplayer/download/update/x64++`

=== Samples

==== Installers

----
E0788A0179FD3ECF7BC9E65C1C9F107D8F2C3142
CDE4D12EF9F70988C63B66BF019C379D59A0E61F
04FB0667B4A4EB1831BE88958E6127CD7317638A
BA3519E62618B86D10830EF256CCE010014E401A
4B5610AC5070A7D53041CC266630028D62935E3F
----

==== Loader (`.tlb`)

----
F5ABFB972495FDE3D4FB3C825C3BBC437AAB6C3A
BEE79383BCC73CF1E8E938131179223ADB39AC1D
----

==== Win32 Backdoor (`.pdb`)

----
24925A2E8DE38F2498906F8088CF2A8939E3CFD3
48BCEC5A65401FBE9DF8626A780F831AD55060A1
E441CC1547B18BBA76D2A8BD4D0F644AD5388082
240D3473932E4D74C09FCC241CF6EC175FDCE49D
----

==== JScript backdoor

----
C51D288469DF9F25E2FB7AC491918B3E579282EA
3DC74671768EB90463C0901570C0AAE24569B573
----

=== Windows artefacts

==== Hijacked CLSID

- `{D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D}`
- `{08244EE6-92F0-47F2-9FC9-929BAA2E7235}`
- `{4E14FBA2-2E22-11D1-9964-00C04FBBB345}`
- `{B5F8350B-0548-48B1-A6EE-88BD00B4A5E7}`
- `{603D3801-BD81-11D0-A3A5-00C04FD706EC}`
- `{F82B4EF1-93A9-4DDE-8015-F7950A1A6E31}`
- `{9207D8C7-E7C8-412E-87F8-2E61171BD291}`
- `{A3B3C46C-05D8-429B-BF66-87068B4CE563}`
- `{0997898B-0713-11D2-A4AA-00C04F8EEB3E}`
- `{603D3801-BD81-11D0-A3A5-00C04FD706EC}`
- `{1299CF18-C4F5-4B6A-BB0F-2299F0398E27}`

==== Files

- Three files with the same name but a different extension (`.tlb`, `.pdb` and `.tnl`)
in a folder `of %APPDATA%`
- `%APPDATA%\kb6867.bin` (simplified log file)
- `%APPDATA%\Microsoft\local_update_checker.js` (JScript backdoor)
- `%APPDATA%\Microsoft\google_update_checker.js` (JScript backdoor)

== Turla Outlook Indicators of Compromise

The white paper about Turla Outlook is available on WeLiveSecurity at https://www.welivesecurity.com/wp-content/uploads/2018/08/Eset-Turla-Outlook-Backdoor.pdf.
A high level summary is also available as a blog post on WeLiveSecurity at https://www.welivesecurity.com/2018/08/22/turla-unique-outlook-backdoor/.

The https://www.misp-project.org[MISP] event is available at https://github.com/eset/malware-ioc/blob/master/turla/misp-turla-outlook-event.json.

=== Sample hashes

[options="header"]
|========================================
|SHA-1 hash|Component|Compilation Time (GMT)|ESET Detection Name
|`8A7E2399A61EC025C15D06ECDD9B7B37D6245EC2`|Backdoor|2013-06-28 14:15:54|Win32/Turla.N
|`F992ABE8A67120667A01B88CD5BF11CA39D491A0`|Dropper|2014-12-03 20:50:08|Win32/Turla.AW
|`CF943895684C6FF8D1E922A76B71A188CFB371D7`|Backdoor|2014-12-03 20:44:27|Win32/Turla.R
|`851DFFA6CD611DC70C9A0D5B487FF00BC3853F30`|Backdoor|2016-09-15 08:14:47|Win32/Turla.DA
|========================================

=== Filenames
* `%APPDATA%/Microsoft/Windows/scawrdot.db`
* `%APPDATA%/Microsoft/Windows/flobcsnd.dat`
* `mapid.tlb`
* `msmime.dll`

=== Registry Keys
* `HKCU\Software\Microsoft\Windows\CurrentVersion\Settings\ZonePolicy\`
* `HKCU\Software\Classes\CLSID\\{49CBB1C7-97D1-485A-9EC1-A26065633066}`
* `HKCU\Software\Classes\CLSID\\{84DA0A92-25E0-11D3-B9F7-00C04F4C8F5D}`

=== YARA rules
https://github.com/eset/malware-ioc/blob/master/turla/turla-outlook.yar

== LightNeuron Indicators of Compromise

The white paper about Turla LightNeuron is available on WeLiveSecurity at https://www.welivesecurity.com/wp-content/uploads/2019/05/ESET-LightNeuron.pdf.
A high level summary is also available as a blog post on WeLiveSecurity at https://www.welivesecurity.com/2019/05/07/turla-lightneuron-email-too-far/.

The https://www.misp-project.org[MISP] event is available in link:misp-turla-lightneuron-event.json[`misp-turla-lightneuron-event.json`].

=== Sample hashes

[options="header"]
|========================================
|SHA-1 hash|Component|Compilation Time (GMT)|ESET Detection Name
|`3C851E239FBF67A03E0DAE8F63EEE702B330DB6C`|Transport Agent|26/10/2016|MSIL/Turla.A
|`76EE1802A6C920CBEB3A1053A4EC03C71B7E46F8`|Companion DLL|02/09/2016|Win64/Turla.CC
|`FF28B53B55BC77A5B4626F9DB856E67AC598C787`|Transport Agent|16/08/2015|MSIL/Turla.A
|`C1FF6804FDB8656AB08928D187837D28060A552F`|Companion DLL|25/07/2014|Win64/Turla.CC
|`F9D52BB5A30B42FC2D1763BE586CEE8A57424732`|Transport Agent|20/06/2014|MSIL/Turla.A
|`0A9F10925AF42DF94925D07112F303D57392C908`|Companion DLL|01/07/2016|Win64/Turla.CC
|`A4D1A34FE5EFFD90CCB6897679586DDC07FBC5CD`|Transport Agent|20/06/2014|MSIL/Turla.A
|========================================

=== Filenames
* `%tmp%\winmail.dat`
* `C:\Windows\ServiceProfiles\NetworkService\appdata\Local\Temp\msmocf.xml`
* `C:\Windows\ServiceProfiles\NetworkService\appdata\Local\Temp\msmodl.dat`
* `C:\Windows\serviceprofiles\networkservice\appdata\Roaming\Microsoft\Windows\814ad43-58ab-2cd3-3e68-b82a8f402fd0`
* `C:\Windows\serviceprofiles\networkservice\appdata\Roaming\Microsoft\Windows\42cf8a1-6e20-8c24-d35f-82c46d8b70ba`
* `C:\Windows\serviceprofiles\networkservice\appdata\Roaming\Microsoft\Windows\36b1f4a-82b9-eb06-7c1e-90b4b2d5c27d`
* `C:\Windows\ServiceProfiles\NetworkService\AppData\Roaming\Microsoft\thumbcache_idx.db`
* `C:\Windows\ServiceProfiles\NetworkService\AppData\Roaming\Microsoft\Windows\thumbcache_32.db`


== Turla PowerShell Indicators of Compromise

The blog post about Turla PowerShell scripts is available on WeLiveSecurity at
https://www.welivesecurity.com/2019/05/29/turla-powershell-usage/

The https://www.misp-project.org[MISP] event is available in link:misp-turla-powershell-event.json[`misp-turla-powershell-event.json`].

=== Sample hashes

[options="header"]
|========================================
|SHA-1 hash|Description|ESET Detection Name
|`50C0BF9479EFC93FA9CF1AA99BDCA923273B71A1`|PowerShell loader with encrypted payload|PowerShell/Turla.T
|`EC54EF8D79BF30B63C5249AF7A8A3C652595B923`|RPC backdoor (client)|Win64/Turla.BQ
|`9CDF6D5878FC3AECF10761FD72371A2877F270D0`|RPC backdoor (server)|Win64/Turla.BQ
|`D3DF3F32716042404798E3E9D691ACED2F78BDD5`|File exfiltration RPC
plugin|Win32/Turla.BZ
|`9D1C563E5228B2572F5CA14F0EC33CA0DEDA3D57`|RPCSpoofServerInstaller|Win64/Turla.BS
|`B948E25D061039D64115CFDE74D2FF4372E83765`|RPC interface patcher|Win64/Turla.BR
|========================================

=== Filenames
* `%PUBLIC%\iCore.dat` (log file, one-byte XOR 0x55)
* `\\pipe\\atctl` (named pipe)
* `msctx.ps1`
* `C:\Users\Public\Documents\desktop.db`

== Turla Watering Hole Armenia

The blog post about the Turla Watering Hole campaign in Armenia is available on WeLiveSecurity at
https://www.welivesecurity.com/2020/03/12/tracking-turla-new-backdoor-armenian-watering-holes/

The https://www.misp-project.org[MISP] event is available in link:misp-turla-wateringhole-armenia-event.json[`misp-turla-wateringhole-armenia-event.json`].

=== Sample hashes

[options="header"]
|========================================
|SHA-1 hash|Description|ESET Detection Name
|`973620A7AB28A2CBA82DC2A613CD24ED43734381`|NetFlash Dropper|MSIL/Turla.D
|`B6567F988C9ACC5DF3CBD72409FC70D54EA412BB`|NetFlash|MSIL/Turla.D
|`9F81710B85AA7088505C1EECCE9DA94A39A2DC06`|NetFlash|MSIL/Turla.F
|`32430B11E42EDEB63A11E721927FFBABE7C9CFEA`|PyFlash|Win32/Turla.EM
|`620A669EC0451C9F079FB4731F254AC577902E5E`|Skipper communication DLL|Win32/Turla.EJ
|========================================

=== Compromised websites
* `++http://www.armconsul[.]ru/user/themes/ayeps/dist/js/bundle.0eb0f2cb2808b4b35a94.js++`
* `++http://mnp.nkr[.]am/wp-includes/js/jquery/jquery-migrate.min.js++`
* `++http://aiisa[.]am/js/chatem/js_rA9bo8_O3Pnw_5wJXExNhtkUMdfBYCifTJctEJ8C_Mg.js++`
* `++adgf[.]am++`

=== C&C servers
* `++http://skategirlchina[.]com/wp-includes/data_from_db_top.php++`
* `++http://skategirlchina[.]com/wp-includes/ms-locale.php++`
* `++http://37.59.60[.]199/2018/.config/adobe++`
* `++http://134.209.222[.]206:15363++`
* `++http://85.222.235[.]156:8000++`

== Turla ComRAT v4 Indicators of Compromise
The white paper about Turla ComRAT v4 is available on WeLiveSecurity at https://www.welivesecurity.com/wp-content/uploads/2020/05/ESET_Turla_ComRAT.pdf.
A high level summary is also available as a blog post on WeLiveSecurity at https://www.welivesecurity.com/2020/05/26/agentbtz-comratv4-ten-year-journey/.

The https://www.misp-project.org[MISP] event is available in link:misp-turla-comrat-v4-event.json[`misp-turla-comrat-v4-event.json`].

=== Sample hashes

[options="header"]
|========================================
|SHA-1 hash|Description|ESET Detection Name
|`4D8B1F4ACC638080054FFBB4CEF2559583A22DC6`|PowerShell dropper|PowerShell/Turla.X
|`DD7006D16D8E121FCE8F2905433474ECCED75CC0`|ComRAT orchestrator|Win64/Turla.BY
|`0139818441431C72A1935E7F740A1CC458A63452`|ComRAT orchestrator|Win64/Turla.AP
|`0AB87F7BDF7D9E54BA33FE715C11E275D5DCCE15`|ComRAT orchestrator|Win32/Turla.EI
|========================================

=== Paths
* `++%TEMP%\FXSAPIDebugTrace.txt++`
* `++%TEMP%\iecache.bin++`

=== Windows registry
* `++(HKLM|HKCU)\Software\Microsoft\Windows\CurrentVersion\Explorer\CLSID\{59031A47-3F72-44A7-80C5-5595FE6B30EE}++`
* `++HKLM\SOFTWARE\Microsoft\SQMClient\Windows.WSqmCons++`

=== C&C servers
* `++arinas[.]tk++`
* `++bedrost[.]com++`
* `++branter[.]tk++`
* `++bronerg[.]tk++`
* `++celestyna[.]tk++`
* `++crusider[.]tk++`
* `++davilta[.]tk++`
* `++deme[.]ml++`
* `++dixito[.]ml++`
* `++duke6[.]tk++`
* `++elizabi[.]tk++`
* `++foods.jkub[.]com++`
* `++hofa[.]tk++`
* `++hunvin[.]tk++`
* `++lakify[.]ml++`
* `++lindaztert[.]net++`
* `++misters[.]ml++`
* `++pewyth[.]ga++`
* `++progress.zyns[.]com++`
* `++sameera[.]gq++`
* `++sanitar[.]ml++`
* `++scrabble.ikwb[.]com++`
* `++sumefu[.]gq++`
* `++umefu[.]gq++`
* `++vefogy[.]cf++`
* `++vylys[.]com++`
* `++wekanda[.]tk++`


== Turla Crutch Indicators of Compromise
The blogpost about Turla Crutch is available on WeLiveSecurity at https://www.welivesecurity.com/2020/12/02/turla-crutch-keeping-back-door-open.

The https://www.misp-project.org[MISP] event is available in link:misp-turla-crutch-event.json[`misp-turla-crutch-event.json`].

=== Sample hashes

[options="header"]
|========================================
|SHA-1 hash|Description|ESET Detection Name
|`A010D5449D29A1916827FDB443E3C84C405CB2A5`|Crutch dropper similar to Gazer|Win64/Agent.VX
|`2FABCF0FCE7F733F45E73B432F413E564B92D651`|Crutch v3 backdoor (packed)|Win32/Agent.TQL
|`A4AFF23B9A58B598524A71F09AA67994083A9C83`|Crutch v3 backdoor (unpacked)|Win32/Agent.TQL
|`778AA3A58F5C76E537B5FE287912CC53469A6078`|Crutch v4|Win32/Agent.SVE
|========================================

=== Paths
* `++C:\Intel\++`
* `++C:\AMD\Temp\++`
* `++C:\Intel\outllib.dll++`
* `++C:\Intel\lang.nls++`
* `++C:\Intel\~intel_upd.exe++`
* `++C:\Intel\~csrss.exe++`
* `++C:\Program Files (x86)\Google\Chrome\Application\dwmapi.dll++`
* `++C:\Program Files (x86)\Mozilla Firefox\rasadhlp.dll++`
* `++%LOCALAPPDATA%\Microsoft\OneDrive\dwmapi.dll++`


=== C&C servers
* `++hotspot.accesscam[.]org++`
* `++highcolumn.webredirect[.]org++`
* `++ethdns.mywire[.]org++`
* `++theguardian.webredirect[.]org++`
* `++https://raw.githubusercontent[.]com/ksRD18pro/ksRD18/master/ntk.tmp++`
